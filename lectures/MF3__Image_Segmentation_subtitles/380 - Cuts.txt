Now we're going to take this flow network, and we're going to run the max-flow on it. We're going to get a flow of maximum size, and we know that the size of the maximum flow equals the capacity the minimum S, T cut. Now let's try to understand S, T cuts. For a particular partition F, B, what is the capacity of that cut? Recall the capacity of this cut, and the capacity of the edges that go from F to B. So which S go from F to B? Recall we only get these edges that go from F to B. We don't get the edges that go from B to F. So let's define a partition or cut in this graph. Let's suppose that these four pixels get assigned to the foreground. So this is our set F, and the remaining five, six vertices are in the background B. Now which edge is cross from F to B? Now consider one of these four pixels in the foreground. Notice its edge to T, crosses this cut. So we get this edge from I to T, and what's the capacity of this edge? It's B, I. That was our definition of this flow network. Similarly, look at these pixels assigned to the background. For each of these five pixels, we get the edge from S to that pixel, and that edge from S originates in F, and ends in B. So it crosses this cut from F to B. And what's the capacity of this edge from S to this pixel? And that was defined to be F, J. Finally, for each of these separated edges, we get the edge in one direction, but not the other direction. We get this edge, this edge, this edge, and this edge. But notice we don't get the other direction edge. So for each edge in the original undirected graph, if I is assigned to the foreground, and J is assigned to the background, then we get the edge from I to J, and the capacity is P, I, J. Now if you sum up these terms, what do you get? That's the capacity of this cut, F, B. And that's exactly equal to W prime of F, B. That was our definition of W prime. We summed over pixels in the foreground of B, I. Pixels in the background of F, J, and the separation penalty. That's great. Our capacity is exactly equal to the quantity W prime, and our goal was to minimize W prime. If we run max-flow, we find a mins S, T cut. That's a cut with minimum capacity. So, we found the cut, the partition which minimizes W prime.