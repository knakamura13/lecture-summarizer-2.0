1
00:00:00,000 --> 00:00:03,030
 Now, let's look at properties of the graph and how

2
00:00:03,030 --> 00:00:06,570
 these properties manifest themselves in the DFS tree.

3
00:00:06,570 --> 00:00:08,250
 Let's look now at cycles.

4
00:00:08,250 --> 00:00:11,410
 How does the cycle manifest itself in the DFS tree?

5
00:00:11,410 --> 00:00:14,565
 The key property is that graph G has a cycle,

6
00:00:14,565 --> 00:00:18,240
 if and only if, it's DFS tree has a back edge.

7
00:00:18,240 --> 00:00:20,365
 Now, this doesn't matter where we start the DFS.

8
00:00:20,365 --> 00:00:22,135
 What is the starting vertex?

9
00:00:22,135 --> 00:00:26,745
 It doesn't matter how the vertices are ordered in the adjacency list representation also.

10
00:00:26,745 --> 00:00:28,200
 For any start vertex,

11
00:00:28,200 --> 00:00:29,955
 for any ordering on the vertices,

12
00:00:29,955 --> 00:00:32,710
 for any ordering on the neighbors of every vertex,

13
00:00:32,710 --> 00:00:35,400
 the DFS tree will contain a back edge,

14
00:00:35,400 --> 00:00:37,965
 if and only if, G has a cycle.

15
00:00:37,965 --> 00:00:39,000
 So, if there is a cycle,

16
00:00:39,000 --> 00:00:42,315
 there will be a back edge that will appear in our DFS tree.

17
00:00:42,315 --> 00:00:44,820
 And if the DFS tree contains a back edge,

18
00:00:44,820 --> 00:00:46,880
 then there is a cycle in the graph.

19
00:00:46,880 --> 00:00:48,775
 Let's see why this property holds.

20
00:00:48,775 --> 00:00:50,310
 This is an equivalence relation.

21
00:00:50,310 --> 00:00:52,205
 So let's look at the two implications.

22
00:00:52,205 --> 00:00:54,180
 Let's look at first at the forward implication.

23
00:00:54,180 --> 00:00:58,260
 Let's suppose that G has a cycle and let's see how a back edge appears.

24
00:00:58,260 --> 00:01:02,940
 Let's suppose the graph G has a cycle and let's label the vertices of that cycle as a,

25
00:01:02,940 --> 00:01:04,915
 b, c, up to j.

26
00:01:04,915 --> 00:01:06,540
 So, there's an edge from a to b,

27
00:01:06,540 --> 00:01:09,385
 b to c, up to j, and then back to a.

28
00:01:09,385 --> 00:01:11,995
 Now, one of these vertices has to be explored first.

29
00:01:11,995 --> 00:01:13,765
 There always has to be somebody first.

30
00:01:13,765 --> 00:01:16,120
 So, let's say the first vertex is vertex i.

31
00:01:16,120 --> 00:01:18,415
 So, what do we know then about our DFS tree?

32
00:01:18,415 --> 00:01:20,155
 We know we have this vertex i.

33
00:01:20,155 --> 00:01:22,630
 And now if we look at the sub-tree of i,

34
00:01:22,630 --> 00:01:26,355
 we know that all these other vertices of the cycle are reachable from i.

35
00:01:26,355 --> 00:01:29,500
 So, they're all going to lie in the sub-tree rooted at i.

36
00:01:29,500 --> 00:01:31,470
 So, all the other vertices of the cycle are going

37
00:01:31,470 --> 00:01:33,600
 to be contained in this sub-tree rooted at i.

38
00:01:33,600 --> 00:01:36,355
 We don't know anything else about the structure of this sub-tree,

39
00:01:36,355 --> 00:01:38,595
 we just know that this sub-tree contains

40
00:01:38,595 --> 00:01:43,290
 all the other vertices of this cycle because they're all reachable from vertex i.

41
00:01:43,290 --> 00:01:46,710
 Now at least one of these vertices has an edge to i.

42
00:01:46,710 --> 00:01:49,920
 In this case, we know that i - 1 has an edge to i.

43
00:01:49,920 --> 00:01:52,275
 This edge is going to appear as a back edge

44
00:01:52,275 --> 00:01:55,500
 because it goes from a descendant to an ancestor.

45
00:01:55,500 --> 00:01:58,375
 So we're going to have a back edge from i minus one to i.

46
00:01:58,375 --> 00:02:00,170
 Now, let's look at the reverse implication.

47
00:02:00,170 --> 00:02:02,820
 Let's suppose that our DFS tree has a back edge and

48
00:02:02,820 --> 00:02:05,835
 let's prove that the graph then must contain a cycle.

49
00:02:05,835 --> 00:02:09,690
 Let's say there is a back edge from vertex a to vertex b. So, what do we know?

50
00:02:09,690 --> 00:02:12,180
 We know that vertex a is a descendant of vertex b,

51
00:02:12,180 --> 00:02:14,190
 and there's this back edge from a to b.

52
00:02:14,190 --> 00:02:17,475
 But since a is a descendant of b in this DFS tree,

53
00:02:17,475 --> 00:02:21,615
 we know there's a sequence of tree edges which go from b down to a.

54
00:02:21,615 --> 00:02:23,520
 And notice we now have our cycle.

55
00:02:23,520 --> 00:02:26,100
 These tree edges are edges in the graph and

56
00:02:26,100 --> 00:02:28,620
 then this back edge is also the edge of the graph.

57
00:02:28,620 --> 00:02:32,175
 So, we have our cycle from b down to a and then back to b.

58
00:02:32,175 --> 00:02:33,585
 That shows that there is a cycle.

59
00:02:33,585 --> 00:02:35,460
 For every back edge, there is a cycle.

60
00:02:35,460 --> 00:02:35,460
 That proves this property.

